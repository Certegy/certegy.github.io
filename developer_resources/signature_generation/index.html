<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <title>Signature Generation - Oxipay Documentation</title>
  

  <link rel="shortcut icon" href="../../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Signature Generation";
    var mkdocs_page_input_path = "developer_resources\signature_generation.md";
    var mkdocs_page_url = "/developer_resources/signature_generation/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Oxipay Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../..">Home</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Platforms</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../platforms/shopify/">Shopify</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../platforms/woocommerce/">WooCommerce</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../platforms/magento_1/">Magento 1</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../platforms/magento_2/">Magento 2</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../platforms/onestep/">OneStep</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Developer Resources</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../introduction/">Introduction</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../checkout_process/">Checkout Process</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../api_reference/">API Reference</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../sample_curl/">Sample cURL Script</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Signature Generation</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#signature-generation">Signature Generation</a></li>
                
                    <li><a class="toctree-l4" href="#php-example">PHP Example</a></li>
                
            
            </ul>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Marketing & Advertising</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guidelines/banner-adverts/">Introduction</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guidelines/installing-simple/">Installing the Simple Way</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guidelines/installing-complex/">Installing the Complex Way</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guidelines/banners/">Banners and Tags list</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Oxipay Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Developer Resources &raquo;</li>
        
      
    
    <li>Signature Generation</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="signature-generation">Signature Generation</h1>
<p>In order to prevent against malicious attacks and hijacking of browser sessions,  Oxipay implements a signing mechanism based on HMAC-SHA256. This section provides information on how you can use HMAC-SHA256 for signing and verification purposes.</p>
<p>As mentioned, Oxipay uses HMAC-SHA256 for purposes of signing and verifying request and response POSTs whereby:</p>
<ul>
<li>
<p>The <em>API Key</em> serves as the <code>key</code> for HMAC-SHA256. This API key is only known to Oxipay and the merchant. Note that API keys are unique to every merchant and are also recycled on a regular basis.</p>
</li>
<li>
<p>The HTTP POST serves as the <code>message</code> and is the string of all key-value pairs that represent the transaction request POST. Note that the keys for the various key-value pairs are prefixed with <code>x_</code>. Also note that you would need to sort the various keys alphabetically.</p>
</li>
</ul>
<p>The resulting HMAC-SHA256 signature needs to be hex-encoded and passed along with the remainder of the transaction payload as a value of the key <code>x_signature</code></p>
<p>Below is an example that demonstrates how you can go about implementing a method in a shopping platform that is based on PHP to generate the signature.</p>
<h2 id="php-example">PHP Example</h2>
<p>Below is a PHP code snippet that demonstrates how a signature might be generated in the context of Oxipay:</p>
<pre><code class="php">    function oxipay_sign($query, $api_key )
    {
        $clear_text = '';
        ksort($query);
        foreach ($query as $key =&gt; $value) {
            if (substr($key, 0, 2) === &quot;x_&quot;) {
                $clear_text .= $key . $value;
            }
        }
        $hash = hash_hmac( &quot;sha256&quot;, $clear_text, $api_key);
        return str_replace('-', '', $hash);
    }
</code></pre>

<p>First note that the method expects two parameters and they are <code>$query</code> and <code>$api_key</code>. The <code>$query</code> represents the various key-value pairs that form your HTTP request POST and vary depending on the information that is entered as part of the checkout process on your shopping cart.</p>
<p>The parameter <code>$api_key</code> represents the API Key that is unique for that particular merchant and is constant since it should be hardcoded within your Oxipay plugin. It will only change once the API key has been recycled and the value has been updated in the Oxipay plugin.</p>
<p>Having received the two parameters, the <code>oxipay_sign</code> method will then perform an alphabetical sorting of the various key-value pairs based on the key but still maintaining the correlation between the keys and their respective values.</p>
<p>The method will then examine the <code>$query</code> variable for the various key-value pairs by checking for the <code>x_</code> prefix and would then append then together.</p>
<p>The method then computes the keyed hash value using the <code>hash_hmac</code> method.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../guidelines/banner-adverts/" class="btn btn-neutral float-right" title="Introduction">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../sample_curl/" class="btn btn-neutral" title="Sample cURL Script"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../sample_curl/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../guidelines/banner-adverts/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
